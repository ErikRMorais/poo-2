{% extends "base.html" %}

{% block title %}Checkout - SCEE{% endblock %}

{% block content %}
<h1>Finalizar Compra</h1>

<div class="checkout-container">
    <div class="checkout-resumo">
        <h2>Resumo do Pedido</h2>
        <table class="resumo-table">
            {% for item in itens %}
            <tr>
                <td>{{ item.nome }} (x{{ item.quantidade }})</td>
                <td>R$ {{ "%.2f"|format(item.subtotal) }}</td>
            </tr>
            {% endfor %}
            <tr class="total-row">
                <td><strong>Total:</strong></td>
                <td><strong>R$ {{ "%.2f"|format(total) }}</strong></td>
            </tr>
        </table>
    </div>
    
    <form method="POST" class="checkout-form">
        <h2>EndereÃ§o de Entrega</h2>
        {% if enderecos %}
        <div class="form-group">
            <label for="endereco_id">Selecione o endereÃ§o:</label>
            <select id="endereco_id" name="endereco_id" required>
                {% for endereco in enderecos %}
                <option value="{{ endereco.id }}">
                    {{ endereco.rua }}, {{ endereco.numero }} - {{ endereco.bairro }}, {{ endereco.cidade }}/{{ endereco.estado }}
                </option>
                {% endfor %}
            </select>
        </div>
        {% else %}
        <p>VocÃª nÃ£o possui endereÃ§os cadastrados. <a href="{{ url_for('minha_conta') }}">Adicione um endereÃ§o</a></p>
        {% endif %}
        
        <h2>Tipo de Frete</h2>
        <div class="form-group frete-opcoes">
            <label class="frete-opcao">
                <input type="radio" name="tipo_frete" value="Fixo" required checked>
                <div class="frete-info">
                    <strong>ðŸ“¦ Frete Fixo</strong>
                    <p>R$ 15,00 - Prazo: 7 dias Ãºteis</p>
                    <small>GrÃ¡tis para compras acima de R$ 500,00</small>
                </div>
            </label>
            <label class="frete-opcao">
                <input type="radio" name="tipo_frete" value="Correios" required>
                <div class="frete-info">
                    <strong>ðŸ“® Correios</strong>
                    <p>A partir de R$ 15,00 - Prazo: 5 a 12 dias Ãºteis</p>
                    <small>Valor varia conforme CEP e peso. GrÃ¡tis acima de R$ 500,00</small>
                </div>
            </label>
            <label class="frete-opcao">
                <input type="radio" name="tipo_frete" value="Expresso" required>
                <div class="frete-info">
                    <strong>âš¡ Expresso</strong>
                    <p>A partir de R$ 30,00 - Prazo: 2 a 5 dias Ãºteis</p>
                    <small>Entrega rÃ¡pida! 50% de desconto acima de R$ 500,00</small>
                </div>
            </label>
        </div>
        
        <h2>MÃ©todo de Pagamento</h2>
        <div class="form-group">
            <label>
                <input type="radio" name="metodo_pagamento" value="CartÃ£o" required> ðŸ’³ CartÃ£o de CrÃ©dito
            </label>
            <label>
                <input type="radio" name="metodo_pagamento" value="Pix" required> ðŸ“± Pix
            </label>
            <label>
                <input type="radio" name="metodo_pagamento" value="Boleto" required> ðŸ§¾ Boleto BancÃ¡rio
            </label>
        </div>
        
        {% if enderecos %}
        <button type="submit" class="btn btn-primary btn-large">âœ… Confirmar Pedido</button>
        {% endif %}
    </form>
</div>
{% endblock %}
